

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Explicit factorization models &mdash; Spotlight v0.1.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/spotlight_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Latent representations" href="representations.html" />
    <link rel="prev" title="Implicit factorization models" href="implicit.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/spotlight.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../interactions.html">Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/datasets.html">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasets/synthetic.html">Synthetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/movielens.html">Movielens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/goodbooks.html">Goodbooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cross_validation.html">Cross validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sequence/sequence.html">Sequence models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sequence/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sequence/representations.html">Sequence representations</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="factorization.html">Factorization models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Explicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="representations.html">Latent representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../losses.html">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sampling.html">Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serialization.html">Model Serialization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../serialization.html#saving-and-loading-the-model">Saving and loading the model</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#unreleased-unreleased">Unreleased (unreleased)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#v0-1-5-2018-05-20">v0.1.5 (2018-05-20)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id1">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#v0-1-4-2018-02-18">v0.1.4 (2018-02-18)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#fixed">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id2">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#v0-1-3-2017-12-14">v0.1.3 (2017-12-14)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#changed">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#v0-1-2-2017-09-10">v0.1.2 (2017-09-10)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id3">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id4">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id5">Fixed</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spotlight</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="factorization.html">Factorization models</a> &raquo;</li>
        
      <li>Explicit factorization models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/factorization/explicit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-spotlight.factorization.explicit">
<span id="explicit-factorization-models"></span><h1>Explicit factorization models<a class="headerlink" href="#module-spotlight.factorization.explicit" title="Permalink to this headline">¶</a></h1>
<p>Factorization models for explicit feedback problems.</p>
<dl class="class">
<dt id="spotlight.factorization.explicit.ExplicitFactorizationModel">
<em class="property">class </em><code class="sig-prename descclassname">spotlight.factorization.explicit.</code><code class="sig-name descname">ExplicitFactorizationModel</code><span class="sig-paren">(</span><em class="sig-param">loss='regression'</em>, <em class="sig-param">embedding_dim=32</em>, <em class="sig-param">n_iter=10</em>, <em class="sig-param">batch_size=256</em>, <em class="sig-param">l2=0.0</em>, <em class="sig-param">learning_rate=0.01</em>, <em class="sig-param">optimizer_func=None</em>, <em class="sig-param">use_cuda=False</em>, <em class="sig-param">representation=None</em>, <em class="sig-param">sparse=False</em>, <em class="sig-param">random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spotlight/factorization/explicit.html#ExplicitFactorizationModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.factorization.explicit.ExplicitFactorizationModel" title="Permalink to this definition">¶</a></dt>
<dd><p>An explicit feedback matrix factorization model. Uses a classic
matrix factorization <a class="footnote-reference brackets" href="#id2" id="id1">1</a> approach, with latent vectors used
to represent both users and items. Their dot product gives the
predicted score for a user-item pair.</p>
<p>The latent representation is given by
<a class="reference internal" href="representations.html#spotlight.factorization.representations.BilinearNet" title="spotlight.factorization.representations.BilinearNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">spotlight.factorization.representations.BilinearNet</span></code></a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Koren, Yehuda, Robert Bell, and Chris Volinsky.
“Matrix factorization techniques for recommender systems.”
Computer 42.8 (2009).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<em>string</em><em>, </em><em>optional</em>) – One of ‘regression’, ‘poisson’, ‘logistic’
corresponding to losses from <a class="reference internal" href="../losses.html#module-spotlight.losses" title="spotlight.losses"><code class="xref py py-class docutils literal notranslate"><span class="pre">spotlight.losses</span></code></a>.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of embedding dimensions to use for users and items.</p></li>
<li><p><strong>n_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations to run.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Minibatch size.</p></li>
<li><p><strong>l2</strong> (<em>float</em><em>, </em><em>optional</em>) – L2 loss penalty.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Initial learning rate.</p></li>
<li><p><strong>optimizer_func</strong> (<em>function</em><em>, </em><em>optional</em>) – Function that takes in module parameters as the first argument and
returns an instance of a PyTorch optimizer. Overrides l2 and learning
rate if supplied. If no optimizer supplied, then use ADAM by default.</p></li>
<li><p><strong>use_cuda</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Run the model on a GPU.</p></li>
<li><p><strong>representation</strong> (<em>a representation module</em><em>, </em><em>optional</em>) – If supplied, will override default settings and be used as the
main network module in the model. Intended to be used as an escape
hatch when you want to reuse the model’s training functions but
want full freedom to specify your network topology.</p></li>
<li><p><strong>sparse</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Use sparse gradients for embedding layers.</p></li>
<li><p><strong>random_state</strong> (<em>instance of numpy.random.RandomState</em><em>, </em><em>optional</em>) – Random state to use when fitting.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="spotlight.factorization.explicit.ExplicitFactorizationModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">interactions</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spotlight/factorization/explicit.html#ExplicitFactorizationModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.factorization.explicit.ExplicitFactorizationModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model.</p>
<p>When called repeatedly, model fitting will resume from
the point at which training stopped in the previous fit
call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interactions</strong> (<a class="reference internal" href="../interactions.html#spotlight.interactions.Interactions" title="spotlight.interactions.Interactions"><code class="xref py py-class docutils literal notranslate"><span class="pre">spotlight.interactions.Interactions</span></code></a>) – The input dataset. Must have ratings.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Output additional information about current epoch and loss.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="spotlight.factorization.explicit.ExplicitFactorizationModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">user_ids</em>, <em class="sig-param">item_ids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spotlight/factorization/explicit.html#ExplicitFactorizationModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.factorization.explicit.ExplicitFactorizationModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make predictions: given a user id, compute the recommendation
scores for items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_ids</strong> (<em>int</em><em> or </em><em>array</em>) – If int, will predict the recommendation scores for this
user for all items in item_ids. If an array, will predict
scores for all (user, item) pairs defined by user_ids and
item_ids.</p></li>
<li><p><strong>item_ids</strong> (<em>array</em><em>, </em><em>optional</em>) – Array containing the item ids for which prediction scores
are desired. If not supplied, predictions for all items
will be computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>predictions</strong> – Predicted scores for all items in item_ids.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="representations.html" class="btn btn-neutral float-right" title="Latent representations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="implicit.html" class="btn btn-neutral float-left" title="Implicit factorization models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Maciej Kula

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>