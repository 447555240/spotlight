

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Loss functions &mdash; Spotlight v0.1.6 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/spotlight_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Evaluation" href="evaluation.html" />
    <link rel="prev" title="Layers" href="layers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/spotlight.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.1.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interactions.html">Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets/datasets.html">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datasets/synthetic.html">Synthetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets/movielens.html">Movielens</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets/goodbooks.html">Goodbooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cross_validation.html">Cross validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence/sequence.html">Sequence models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sequence/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequence/representations.html">Sequence representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="factorization/factorization.html">Factorization models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="factorization/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorization/explicit.html">Explicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorization/representations.html">Latent representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Layers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="serialization.html">Model Serialization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="serialization.html#saving-and-loading-the-model">Saving and loading the model</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-1-6-2018-05-20">v0.1.6 (2018-05-20)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-1-5-2018-05-20">v0.1.5 (2018-05-20)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id1">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-1-4-2018-02-18">v0.1.4 (2018-02-18)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#fixed">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id2">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-1-3-2017-12-14">v0.1.3 (2017-12-14)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#changed">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-1-2-2017-09-10">v0.1.2 (2017-09-10)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id3">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id4">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id5">Fixed</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Spotlight</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Loss functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/losses.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-spotlight.losses">
<span id="loss-functions"></span><h1>Loss functions<a class="headerlink" href="#module-spotlight.losses" title="Permalink to this headline">¶</a></h1>
<p>Loss functions for recommender models.</p>
<p>The pointwise, BPR, and hinge losses are a good fit for
implicit feedback models trained through negative sampling.</p>
<p>The regression and Poisson losses are used for explicit feedback
models.</p>
<dl class="function">
<dt id="spotlight.losses.adaptive_hinge_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">adaptive_hinge_loss</code><span class="sig-paren">(</span><em class="sig-param">positive_predictions</em>, <em class="sig-param">negative_predictions</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#adaptive_hinge_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.adaptive_hinge_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Adaptive hinge pairwise loss function. Takes a set of predictions
for implicitly negative items, and selects those that are highest,
thus sampling those negatives that are closes to violating the
ranking implicit in the pattern of user interactions.</p>
<p>Approximates the idea of weighted approximate-rank pairwise loss
introduced in <a class="footnote-reference brackets" href="#id2" id="id1">2</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positive_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for known positive items.</p></li>
<li><p><strong>negative_predictions</strong> (<em>tensor</em>) – Iterable of tensors containing predictions for sampled negative items.
More tensors increase the likelihood of finding ranking-violating
pairs, but risk overfitting.</p></li>
<li><p><strong>mask</strong> (<em>tensor</em><em>, </em><em>optional</em>) – A binary tensor used to zero the loss from some entries
of the loss tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Weston, Jason, Samy Bengio, and Nicolas Usunier. “Wsabie:
Scaling up to large vocabulary image annotation.” IJCAI.
Vol. 11. 2011.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spotlight.losses.bpr_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">bpr_loss</code><span class="sig-paren">(</span><em class="sig-param">positive_predictions</em>, <em class="sig-param">negative_predictions</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#bpr_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.bpr_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bayesian Personalised Ranking <a class="footnote-reference brackets" href="#id4" id="id3">1</a> pairwise loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positive_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for known positive items.</p></li>
<li><p><strong>negative_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for sampled negative items.</p></li>
<li><p><strong>mask</strong> (<em>tensor</em><em>, </em><em>optional</em>) – A binary tensor used to zero the loss from some entries
of the loss tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p>Rendle, Steffen, et al. “BPR: Bayesian personalized ranking from
implicit feedback.” Proceedings of the twenty-fifth conference on
uncertainty in artificial intelligence. AUAI Press, 2009.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spotlight.losses.hinge_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">hinge_loss</code><span class="sig-paren">(</span><em class="sig-param">positive_predictions</em>, <em class="sig-param">negative_predictions</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#hinge_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.hinge_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Hinge pairwise loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positive_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for known positive items.</p></li>
<li><p><strong>negative_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for sampled negative items.</p></li>
<li><p><strong>mask</strong> (<em>tensor</em><em>, </em><em>optional</em>) – A binary tensor used to zero the loss from some entries
of the loss tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spotlight.losses.logistic_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">logistic_loss</code><span class="sig-paren">(</span><em class="sig-param">observed_ratings</em>, <em class="sig-param">predicted_ratings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#logistic_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.logistic_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Logistic loss for explicit data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observed_ratings</strong> (<em>tensor</em>) – Tensor containing observed ratings which
should be +1 or -1 for this loss function.</p></li>
<li><p><strong>predicted_ratings</strong> (<em>tensor</em>) – Tensor containing rating predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spotlight.losses.pointwise_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">pointwise_loss</code><span class="sig-paren">(</span><em class="sig-param">positive_predictions</em>, <em class="sig-param">negative_predictions</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#pointwise_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.pointwise_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Logistic loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positive_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for known positive items.</p></li>
<li><p><strong>negative_predictions</strong> (<em>tensor</em>) – Tensor containing predictions for sampled negative items.</p></li>
<li><p><strong>mask</strong> (<em>tensor</em><em>, </em><em>optional</em>) – A binary tensor used to zero the loss from some entries
of the loss tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spotlight.losses.poisson_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">poisson_loss</code><span class="sig-paren">(</span><em class="sig-param">observed_ratings</em>, <em class="sig-param">predicted_ratings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#poisson_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.poisson_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Poisson loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observed_ratings</strong> (<em>tensor</em>) – Tensor containing observed ratings.</p></li>
<li><p><strong>predicted_ratings</strong> (<em>tensor</em>) – Tensor containing rating predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spotlight.losses.regression_loss">
<code class="sig-prename descclassname">spotlight.losses.</code><code class="sig-name descname">regression_loss</code><span class="sig-paren">(</span><em class="sig-param">observed_ratings</em>, <em class="sig-param">predicted_ratings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spotlight/losses.html#regression_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spotlight.losses.regression_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Regression loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observed_ratings</strong> (<em>tensor</em>) – Tensor containing observed ratings.</p></li>
<li><p><strong>predicted_ratings</strong> (<em>tensor</em>) – Tensor containing rating predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean value of the loss function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss, float</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="evaluation.html" class="btn btn-neutral float-right" title="Evaluation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="layers.html" class="btn btn-neutral float-left" title="Layers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Maciej Kula

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>